import{a as d}from"./useFileUpload.a9246a36.js";import{_ as f}from"./plugin-vue_export-helper.21dcd24c.js";import{E as p}from"./request.1b18911b.js";import{o as l,a as m,f as _,U as u,V as v,p as g}from"./index.544cacf2.js";import"./common.2468cf2c.js";import"./useCommon.b74cc26c.js";import"./index.e933e8df.js";import"./base.ea2e1c8f.js";import"./index.6a021637.js";import"./event.776e7e11.js";import"./index.56aaff70.js";import"./scroll.691b983f.js";import"./event.3ec63147.js";import"./focus-trap.7fae4b98.js";import"./validator.267e7406.js";import"./index.e1fa80b6.js";import"./index.22b79fd0.js";import"./directive.9587be4d.js";const h=t=>(u("data-v-acdcdb0a"),t=t(),v(),t),w={class:"zfile-office-viewer"},y=h(()=>g("div",{id:"office-body"},null,-1)),E=[y],S={__name:"OfficeViewer",props:{fileUrl:String,fileName:String},setup(t){const o=t;let r=d();l(()=>{n(`${r.globalConfig.onlyOfficeUrl}/web-apps/apps/api/documents/api.js`,()=>{const i=o.fileName.lastIndexOf("."),e={document:{fileType:o.fileName.substr(i+1),title:o.fileName,url:o.fileUrl,lang:"zh-CN"},width:"100%",editorConfig:{mode:"view",lang:"zh-CN"}};new DocsAPI.DocEditor("office-body",e)})});function n(i,a){let e=document.createElement("script"),c=document.getElementsByTagName("head")[0];e.type="text/javascript",e.charset="UTF-8",e.src=i,e.addEventListener?(e.addEventListener("load",function(){a()},!1),e.addEventListener("error",function(){p.warning("\u8C03\u7528\u5728\u7EBF\u6587\u6863\u670D\u52A1\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u5728\u7EBF\u6587\u6863\u670D\u52A1\u662F\u5426\u6B63\u5E38")},!1)):e.attachEvent&&e.attachEvent("onreadystatechange",function(){var s=window.event.srcElement;s.readyState==="loaded"&&a()}),c.appendChild(e)}return(i,a)=>(m(),_("div",w,E))}};var P=f(S,[["__scopeId","data-v-acdcdb0a"]]);export{P as default};
